@import './Variables.scss';
@import '@styles/table-mixins.scss';

$bill-flex-grid-gap: calc(.25em + .5vw);
$window-padding: $bill-flex-grid-gap;

$row-padding: .375em;
$label-padding: calc($row-padding/2) .75em;
$column-gap: 3em;
$background: var(--window);

.spending-categories {
    flex: 2 1 0;
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    position: relative;
    z-index: 0;
    gap: 1em;

    &--container {
        display: flex;
        gap: $column-gap;
        align-items: flex-start;
        max-height: 100%;
        background-color: inherit;
    }

    &.tabbed {

        &>.spending-categories--container {
            flex-direction: column;
            gap: calc($column-gap/3);

            &>div:last-child {
                width: 100%;
            }
        }
    }

    div[role='tablist'] {
        display: flex;
        gap: 1em;

        button[aria-selected='false'] {
            opacity: .3;
        }
    }

    .column {
        flex: 1;
        width: 100%;
        overflow-y: scroll;
        scrollbar-width: none;
        height: 100%;
        background-color: inherit;
        position: relative;
        // Aprx. 5 rows
        // the 2em comes from the bottom buttons space
        min-height: calc(3 * (1em + 2 * $item-row-gap + 2 * $row-padding) + 2.75em);

        &.skeleton {
            display: flex;
            flex-direction: column;
            gap: .5em;
        }

        &--header {
            display: flex;
            align-items: center;
            gap: .5em;
            position: sticky;
            top: 0;
            z-index: 1;
            background-color: inherit;
            display: flex;
            align-items: center;
            padding-bottom: 1em;
        }

        &--grid {
            display: grid;
            grid-template-columns: 1fr auto auto auto auto;
            row-gap: $item-row-gap;
            background-color: inherit;

            .category-shimmer {
                grid-column: 1/span 4;
            }

            &>div {
                position: relative;

                @mixin dot($background-color) {
                    &::after {
                        content: '';
                        position: absolute;
                        top: 50%;
                        left: .75em;
                        transform: translate(-50%, -50%);
                        width: .625em;
                        height: .625em;
                        border-radius: 50%;
                        background-color: $background-color;
                    }
                }

                // Total Cell
                &:first-child {
                    position: relative;
                    padding-left: 2.2em;

                    &.month {
                        @include dot(var(--monthly-background-color));
                    }

                    &.year {
                        @include dot(var(--yearly-background-color));
                    }
                }


                // Emoji + name columns
                &:nth-child(5n+1) {
                    display: flex;
                    align-items: center;
                }

                // Name  emoji columns
                &:nth-child(5n+1) {
                    gap: .75em;
                    z-index: 0;
                    position: relative;
                    padding-right: 1em;
                    overflow: hidden;
                    mask-image: linear-gradient(to right, black, black calc(100% - 1em), transparent);
                }

                // Progress circle
                &:not(.column--header):nth-child(5n) {
                    display: flex;
                    justify-content: flex-end;
                    align-items: center;
                }

                // Spent of column
                &:nth-child(5n+3) {
                    display: flex;
                    padding: 0 1.25em;
                    color: var(--m-text-quaternary);
                    font-size: .875em;
                    display: flex;
                    padding-top: .125em;
                }

                &:nth-child(5n+4) {
                    padding-right: 1em;

                    span.no-limit {
                        display: flex;
                        padding-left: .25em;
                    }
                }
            }

        }
    }
}
